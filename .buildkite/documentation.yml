steps:
  - label: ":page_facing_up: Build and Deploy Documentation"
    plugins:
      - JuliaCI/julia#v1:
          version: "1"
    command: |
      julia --project=docs -e '
        println("--- :julia: Instantiating project")
        using Pkg
        Pkg.develop(PackageSpec(path=pwd()))
        Pkg.instantiate()
        println("--- :julia: Building documentation")
        include("docs/make.jl")
      '
    agents:
      queue: "juliagpu"
      cuda: "*"
    env:
      DATADEPS_ALWAYS_ACCEPT: true
    if: build.message !~ /\[skip docs\]/ && !build.pull_request.draft
    timeout_in_minutes: 1000

env:
  JULIA_PKG_SERVER: "" # it often struggles with our large artifacts
  SECRET_DOCUMENTER_KEY: "HB5MqV6hXmNbb4b0143k0hZDN1zI3sxcUxBc/8njNrGicgYM4f9FR7TxRw9fbYlj+PmjPZfbqITiYRgUwHSVpTPR6ypbXr4sW20Z9/yWUSi6JFDaF/VxgcAtgmvqLA+D4vAHvvkEYxtxw1bN1bdot564A07qmMzCdw48AIZw2NgGUeEy04d4zTSFlserSUUhvKosNmZJ/f9P12NgRUPoek5fhFwD3uDMr+4CqY2J6Ob78zF4KN53t7ohQ1rznc1Oywe5msyWq190rIeIva1WuM5CWd4tHfp4dNIDEaV9kKGqFK5GU2F9cSk2gibOEtPskAgcazYcdsI72/CeWYfQbw==;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"